<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Jumu'ah Journal | Premium Khutbah Notes</title>
    
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link href="https://fonts.googleapis.com/css2?family=Amiri:ital@0;1&family=Outfit:wght@300;400;600&family=Playfair+Display:wght@400;700&display=swap" rel="stylesheet">
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

    <style>
        :root {
            /* Palette: Royal Wisdom */
            --bg-gradient: linear-gradient(135deg, #1e130c, #2a1f3d, #0f172a);
            --gold-accent: #d4af37;
            --gold-glow: rgba(212, 175, 55, 0.4);
            --glass-surface: rgba(255, 255, 255, 0.05);
            --glass-border: rgba(255, 255, 255, 0.1);
            --text-primary: #f8fafc;
            --text-secondary: #94a3b8;
            --card-shadow: 0 20px 50px rgba(0,0,0,0.5);
        }

        * { margin: 0; padding: 0; box-sizing: border-box; outline: none; -webkit-tap-highlight-color: transparent; }

        body {
            font-family: 'Outfit', sans-serif;
            background: var(--bg-gradient);
            background-attachment: fixed; /* Parallax effect */
            color: var(--text-primary);
            min-height: 100vh;
            overflow-x: hidden;
            padding-bottom: 100px;
        }

        /* --- BACKGROUND IMAGE OVERLAY --- */
        .bg-image {
            position: fixed;
            top: 0; left: 0; width: 100%; height: 100%;
            background: url('https://images.unsplash.com/photo-1542044806-382a856336a5?q=80&w=2070&auto=format&fit=crop'); 
            background-size: cover;
            background-position: center;
            opacity: 0.15; /* Sangat halus */
            z-index: -1;
            mix-blend-mode: overlay;
        }

        /* --- CONTAINER --- */
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 40px 20px;
        }

        /* --- HEADER --- */
        header {
            text-align: center;
            margin-bottom: 50px;
            position: relative;
        }

        .bismillah {
            font-family: 'Amiri', serif;
            font-size: 32px;
            color: var(--gold-accent);
            margin-bottom: 10px;
            opacity: 0.9;
        }

        h1 {
            font-family: 'Playfair Display', serif;
            font-size: 48px;
            background: linear-gradient(to right, #fff, #94a3b8);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            margin-bottom: 10px;
        }

        .search-container {
            position: relative;
            max-width: 500px;
            margin: 30px auto 0;
        }

        .search-input {
            width: 100%;
            padding: 15px 50px 15px 25px;
            border-radius: 50px;
            border: 1px solid var(--glass-border);
            background: rgba(0,0,0,0.3);
            color: white;
            font-family: 'Outfit';
            font-size: 16px;
            backdrop-filter: blur(10px);
            transition: 0.3s;
        }

        .search-input:focus {
            border-color: var(--gold-accent);
            box-shadow: 0 0 15px var(--gold-glow);
            background: rgba(0,0,0,0.5);
        }

        .search-icon {
            position: absolute;
            right: 20px;
            top: 50%;
            transform: translateY(-50%);
            color: var(--text-secondary);
        }

        /* --- FAB (Floating Action Button) --- */
        .fab-add {
            position: fixed;
            bottom: 40px;
            right: 40px;
            width: 70px;
            height: 70px;
            background: linear-gradient(135deg, var(--gold-accent), #b8860b);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #1a0f0a;
            font-size: 28px;
            box-shadow: 0 10px 30px rgba(212, 175, 55, 0.4);
            cursor: pointer;
            transition: 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            z-index: 100;
            border: none;
        }

        .fab-add:hover {
            transform: scale(1.1) rotate(90deg);
            box-shadow: 0 15px 40px rgba(212, 175, 55, 0.6);
        }

        /* --- NOTES GRID --- */
        .notes-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(350px, 1fr));
            gap: 30px;
        }

     .note-card {
            background: var(--glass-surface);
            backdrop-filter: blur(20px);
            
            /* Border: Keliling tipis, tanpa kanan/kiri jika diinginkan */
            border: 1px solid var(--glass-border);
            border-right: none; 
            /* border-left: none; <--- Sudah aman karena ::before dihapus */
            
            border-radius: 24px;
            padding: 30px;
            transition: 0.4s;
            position: relative;
            overflow: hidden;
            display: flex;
            flex-direction: column;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
            
            /* Scroll Limiter */
            max-height: 500px; 
        }

        /* Pastikan tidak ada kode .note-card::before di bawah ini */
     

        .note-card:hover {
            transform: translateY(-10px);
            background: rgba(255,255,255,0.08);
            border-color: rgba(212, 175, 55, 0.3);
            box-shadow: 0 20px 40px rgba(0,0,0,0.4);
        }

        .card-meta {
            display: flex;
            justify-content: space-between;
            align-items: center;
            font-size: 13px;
            color: var(--text-secondary);
            margin-bottom: 15px;
            font-family: 'Outfit';
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .card-topic {
            font-family: 'Playfair Display', serif;
            font-size: 24px;
            font-weight: 700;
            margin-bottom: 15px;
            color: var(--text-primary);
            line-height: 1.3;
        }

        .card-khatib {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 20px;
            font-size: 14px;
            color: var(--gold-accent);
        }

        .card-content {
            font-size: 15px;
            line-height: 1.8;
            color: #d1d5db;
            flex-grow: 1;
            margin-bottom: 25px;
            white-space: pre-line; /* Agar enter terbaca */
        }

        .card-tags {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
            margin-bottom: 20px;
        }

        .tag {
            font-size: 11px;
            padding: 5px 12px;
            border-radius: 20px;
            background: rgba(255,255,255,0.1);
            color: var(--text-secondary);
            border: 1px solid rgba(255,255,255,0.05);
        }

        .card-actions {
            display: flex;
            justify-content: flex-end;
            gap: 15px;
            border-top: 1px solid rgba(255,255,255,0.1);
            padding-top: 20px;
        }

        .action-btn {
            background: none;
            border: none;
            cursor: pointer;
            color: var(--text-secondary);
            transition: 0.3s;
            font-size: 16px;
        }

        .btn-edit:hover { color: var(--gold-accent); }
        .btn-delete:hover { color: #ef4444; }

        /* --- MODAL FORM --- */
        .modal-overlay {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.8);
            backdrop-filter: blur(8px);
            z-index: 999;
            display: none;
            justify-content: center;
            align-items: center;
            opacity: 0;
            transition: opacity 0.3s;
        }
        .modal-overlay.active { display: flex; opacity: 1; }

        .modal-box {
            background: #1e1e2e;
            width: 90%; max-width: 600px;
            border-radius: 24px;
            border: 1px solid var(--glass-border);
            padding: 40px;
            position: relative;
            transform: scale(0.9);
            transition: transform 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            box-shadow: 0 25px 50px rgba(0,0,0,0.5);
        }
        .modal-overlay.active .modal-box { transform: scale(1); }

        .form-group { margin-bottom: 25px; }
        
        .form-label {
            display: block;
            margin-bottom: 8px;
            font-size: 12px;
            text-transform: uppercase;
            letter-spacing: 1px;
            color: var(--gold-accent);
        }

        .form-input, .form-textarea {
            width: 100%;
            background: rgba(255,255,255,0.05);
            border: 1px solid rgba(255,255,255,0.1);
            padding: 15px;
            border-radius: 12px;
            color: white;
            font-family: 'Outfit';
            font-size: 16px;
            transition: 0.3s;
        }

        .form-input:focus, .form-textarea:focus {
            border-color: var(--gold-accent);
            background: rgba(255,255,255,0.08);
        }

        .form-textarea { min-height: 150px; resize: vertical; }

        .btn-submit {
            width: 100%;
            padding: 15px;
            background: linear-gradient(135deg, var(--gold-accent), #b8860b);
            border: none;
            border-radius: 12px;
            color: #1a0f0a;
            font-weight: 600;
            font-size: 16px;
            cursor: pointer;
            transition: 0.3s;
        }

        .btn-submit:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 20px rgba(212, 175, 55, 0.3);
        }

        .close-modal {
            position: absolute; top: 20px; right: 20px;
            background: none; border: none; color: #666; font-size: 24px; cursor: pointer;
        }
        .close-modal:hover { color: #fff; }

        /* --- TOAST NOTIFICATION --- */
        .toast {
            position: fixed;
            top: 30px;
            right: 30px;
            background: rgba(255,255,255,0.1);
            backdrop-filter: blur(15px);
            padding: 15px 25px;
            border-radius: 50px;
            border: 1px solid var(--glass-border);
            color: white;
            display: flex;
            align-items: center;
            gap: 15px;
            transform: translateX(200%);
            transition: transform 0.5s cubic-bezier(0.68, -0.55, 0.27, 1.55);
            z-index: 2000;
        }
        .toast.show { transform: translateX(0); }
        .toast-icon { color: var(--gold-accent); }

        /* RESPONSIVE */
        @media (max-width: 768px) {
            h1 { font-size: 32px; }
            .notes-grid { grid-template-columns: 1fr; }
            .modal-box { padding: 25px; }
        }
        /* 1. UPDATE KARTU UTAMA */
        .note-card {
            background: var(--glass-surface);
            backdrop-filter: blur(20px);
            
            /* Border */
            border: 1px solid var(--glass-border);
            border-left: none; /* MENGHAPUS BORDER KANAN SESUAI REQUEST */
            
            border-radius: 24px;
            padding: 30px;
            transition: 0.4s;
            position: relative;
            overflow: hidden;
            display: flex;
            flex-direction: column;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
            
            /* BATASI TINGGI KARTU AGAR TIDAK MELUBER */
            max-height: 500px; 
        }

        .note-card::before {
            content: '';
            position: absolute;
            top: 0; left: 0; width: 4px; height: 100%;
            background: var(--gold-accent);
            opacity: 0.7;
        }

        /* 2. UPDATE KONTEN AGAR BISA SCROLL */
        .card-content {
            font-size: 15px;
            line-height: 1.8;
            color: #d1d5db;
            
            /* Scroll Logic */
            flex-grow: 1;          /* Mengisi sisa ruang kartu */
            overflow-y: auto;      /* Munculkan scroll jika konten panjang */
            margin-bottom: 15px;   /* Jarak ke tags */
            padding-right: 10px;   /* Jarak agar teks tidak tertutup scrollbar */
            white-space: pre-line;
            
            /* Firefox Scrollbar */
            scrollbar-width: thin;
            scrollbar-color: var(--gold-accent) rgba(255,255,255,0.05);
        }

        /* 3. STYLING SCROLLBAR PREMIUM (Chrome/Safari/Edge) */
        .card-content::-webkit-scrollbar {
            width: 6px; /* Scrollbar tipis elegan */
        }

        .card-content::-webkit-scrollbar-track {
            background: rgba(255,255,255,0.02); /* Track transparan halus */
            border-radius: 10px;
        }

        .card-content::-webkit-scrollbar-thumb {
            background-color: var(--gold-accent); /* Warna Emas */
            border-radius: 10px;
            opacity: 0.8;
        }

        .card-content::-webkit-scrollbar-thumb:hover {
            background-color: #b8860b; /* Emas lebih gelap saat disentuh */
        }
    </style>
</head>
<body>

    <div class="bg-image"></div>

    <div class="container">
        <header>
            <div class="bismillah">بِسْمِ اللَّهِ الرَّحْمَنِ الرَّحِيم</div>
            <h1>Jumu'ah Notes</h1>
            <p style="color:var(--text-secondary);">Simpan hikmah, amalkan ilmu.</p>
            
            <div class="search-container">
                <input type="text" class="search-input" id="searchInput" placeholder="Cari topik atau nama khatib...">
                <i class="fa-solid fa-search search-icon"></i>
            </div>
        </header>

        <div id="emptyState" style="text-align:center; display:none; margin-top:50px;">
            <i class="fa-solid fa-book-open" style="font-size:60px; color:rgba(255,255,255,0.1); margin-bottom:20px;"></i>
            <p style="color:rgba(255,255,255,0.3);">Belum ada catatan khutbah. Mulailah hari ini.</p>
        </div>

        <div class="notes-grid" id="notesGrid">
            </div>
    </div>

    <button class="fab-add" onclick="openModal()">
        <i class="fa-solid fa-plus"></i>
    </button>

    <div class="modal-overlay" id="noteModal">
        <div class="modal-box">
            <button class="close-modal" onclick="closeModal()">&times;</button>
            <h2 style="font-family:'Playfair Display'; margin-bottom:30px; color:white;">Catatan Khutbah</h2>
            
            <form id="noteForm">
                <input type="hidden" id="noteId"> <div class="form-group">
                    <label class="form-label">Tanggal</label>
                    <input type="date" id="noteDate" class="form-input" required>
                </div>

                <div class="form-group">
                    <label class="form-label">Nama Khatib</label>
                    <input type="text" id="noteKhatib" class="form-input" placeholder="Ustadz..." required>
                </div>

                <div class="form-group">
                    <label class="form-label">Topik Utama</label>
                    <input type="text" id="noteTopic" class="form-input" placeholder="Misal: Keutamaan Sabar" required>
                </div>

                <div class="form-group">
                    <label class="form-label">Tags (Pisahkan dengan koma)</label>
                    <input type="text" id="noteTags" class="form-input" placeholder="Aqidah, Akhlak, Sejarah...">
                </div>

                <div class="form-group">
                    <label class="form-label">Ringkasan / Poin Penting</label>
                    <textarea id="noteContent" class="form-textarea" placeholder="Tulis poin-poin penting khutbah di sini..." required></textarea>
                </div>

                <button type="submit" class="btn-submit">Simpan Catatan</button>
            </form>
        </div>
    </div>

    <div class="toast" id="toast">
        <i class="fa-solid fa-check-circle toast-icon"></i>
        <span id="toastMessage">Berhasil disimpan</span>
    </div>

    <script>
        // --- DATA STATE ---
        let notes = JSON.parse(localStorage.getItem('jumuahNotes')) || [];

        // --- DOM ELEMENTS ---
        const notesGrid = document.getElementById('notesGrid');
        const emptyState = document.getElementById('emptyState');
        const modal = document.getElementById('noteModal');
        const form = document.getElementById('noteForm');
        const searchInput = document.getElementById('searchInput');

        // --- INITIALIZATION ---
        document.addEventListener('DOMContentLoaded', () => {
            renderNotes(notes);
            setDefaultDate();
        });

        // --- RENDER FUNCTION (COMPLEX) ---
        function renderNotes(data) {
            notesGrid.innerHTML = '';
            
            if (data.length === 0) {
                emptyState.style.display = 'block';
                return;
            } else {
                emptyState.style.display = 'none';
            }

            // Sort by Date (Newest first)
            const sortedData = data.sort((a, b) => new Date(b.date) - new Date(a.date));

            sortedData.forEach(note => {
                const dateObj = new Date(note.date);
                const dateStr = dateObj.toLocaleDateString('id-ID', { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' });

                // Generate Tags HTML
                const tagsHtml = note.tags.map(tag => `<span class="tag">#${tag.trim()}</span>`).join('');

                const card = document.createElement('div');
                card.className = 'note-card';
                card.innerHTML = `
                    <div class="card-meta">
                        <span><i class="fa-regular fa-calendar"></i> ${dateStr}</span>
                    </div>
                    
                    <h3 class="card-topic">${note.topic}</h3>
                    
                    <div class="card-khatib">
                        <i class="fa-solid fa-user-tie"></i> 
                        <span>${note.khatib}</span>
                    </div>
                    
                    <div class="card-content">${note.content}</div>
                    
                    <div class="card-tags">${tagsHtml}</div>

                    <div class="card-actions">
                        <button class="action-btn btn-edit" onclick="editNote('${note.id}')" title="Edit">
                            <i class="fa-solid fa-pen-to-square"></i>
                        </button>
                        <button class="action-btn btn-delete" onclick="deleteNote('${note.id}')" title="Hapus">
                            <i class="fa-solid fa-trash"></i>
                        </button>
                    </div>
                `;
                notesGrid.appendChild(card);
            });
        }

        // --- CRUD OPERATIONS ---

        // 1. Save (Create & Update)
        form.addEventListener('submit', (e) => {
            e.preventDefault();

            const id = document.getElementById('noteId').value;
            const date = document.getElementById('noteDate').value;
            const khatib = document.getElementById('noteKhatib').value;
            const topic = document.getElementById('noteTopic').value;
            const content = document.getElementById('noteContent').value;
            const tagsInput = document.getElementById('noteTags').value;
            
            // Convert tags string to array
            const tags = tagsInput.split(',').filter(t => t.trim() !== '');

            if (id) {
                // UPDATE MODE
                const index = notes.findIndex(n => n.id === id);
                if (index !== -1) {
                    notes[index] = { id, date, khatib, topic, tags, content };
                    showToast('Catatan berhasil diperbarui');
                }
            } else {
                // CREATE MODE
                const newNote = {
                    id: Date.now().toString(),
                    date,
                    khatib,
                    topic,
                    tags,
                    content
                };
                notes.push(newNote);
                showToast('Catatan baru berhasil disimpan');
            }

            saveToLocal();
            renderNotes(notes);
            closeModal();
            form.reset();
        });

        // 2. Delete
        window.deleteNote = function(id) {
            if(confirm('Hapus catatan ini?')) {
                notes = notes.filter(n => n.id !== id);
                saveToLocal();
                renderNotes(notes);
                showToast('Catatan dihapus');
            }
        };

        // 3. Edit (Prepare Modal)
        window.editNote = function(id) {
            const note = notes.find(n => n.id === id);
            if (note) {
                document.getElementById('noteId').value = note.id;
                document.getElementById('noteDate').value = note.date;
                document.getElementById('noteKhatib').value = note.khatib;
                document.getElementById('noteTopic').value = note.topic;
                document.getElementById('noteContent').value = note.content;
                document.getElementById('noteTags').value = note.tags.join(', ');
                
                openModal();
            }
        };

        // --- SEARCH FUNCTIONALITY ---
        searchInput.addEventListener('input', (e) => {
            const keyword = e.target.value.toLowerCase();
            const filtered = notes.filter(note => 
                note.topic.toLowerCase().includes(keyword) || 
                note.khatib.toLowerCase().includes(keyword) ||
                note.content.toLowerCase().includes(keyword) ||
                note.tags.some(tag => tag.toLowerCase().includes(keyword))
            );
            renderNotes(filtered);
        });

        // --- HELPER FUNCTIONS ---
        function saveToLocal() {
            localStorage.setItem('jumuahNotes', JSON.stringify(notes));
        }

        function openModal() {
            modal.classList.add('active');
        }

        function closeModal() {
            modal.classList.remove('active');
            setTimeout(() => {
                form.reset();
                document.getElementById('noteId').value = ''; // Clear ID to prevent overwrite
                setDefaultDate();
            }, 300);
        }

        function setDefaultDate() {
            const today = new Date().toISOString().split('T')[0];
            document.getElementById('noteDate').value = today;
        }

        function showToast(msg) {
            const toast = document.getElementById('toast');
            document.getElementById('toastMessage').innerText = msg;
            toast.classList.add('show');
            setTimeout(() => {
                toast.classList.remove('show');
            }, 3000);
        }

        // Close modal on outside click
        modal.addEventListener('click', (e) => {
            if (e.target === modal) closeModal();
        });

    </script>
</body>
</html>